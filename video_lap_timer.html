<!DOCTYPE html><html><head>  <meta charset="UTF-8">  <title>Lap Timer</title>  <meta name="viewport" content="width=device-width, initial-scale=1.0">  <style>    body {      font-family: sans-serif;      background-color: #f2f2f2;      padding: 10px;      text-align: center;      user-select: none;      -webkit-user-select: none;      touch-action: manipulation;    }    video {      width: 100%;      max-width: 600px;      border: 1px solid #ccc;      margin-bottom: 10px;    }    input[type="range"] {      width: 95%;      margin: 10px 0 5px 0;    }    .controls {      display: flex;      justify-content: center;      gap: 6px;      flex-wrap: wrap;      margin-bottom: 10px;    }    button {      font-size: 14px;      padding: 6px 10px;      border-radius: 6px;      border: none;      background-color: #007AFF;      color: white;      user-select: none;      -webkit-user-select: none;      touch-action: manipulation;    }    button:hover {      background-color: #0051bb;    }    #laps {      text-align: left;      max-width: 600px;      margin: 0 auto;      font-size: 16px;    }    .lap-entry {      margin-bottom: 4px;    }    .lap-entry button {      font-size: 12px;      margin-left: 8px;      background-color: #e74c3c;    }    #speedIndicator {      margin-top: 5px;      font-size: 14px;      color: #555;    }  </style></head><body>  <h2>動画ラップ記録アプリ</h2>  <input type="file" id="fileInput" accept="video/*"><br><br>  <video id="video" playsinline></video><br>  <input type="range" id="seekbar" min="0" max="100" step="0.01" value="0">  <div class="controls">    <button id="stepBackwardBtn">←</button>    <button id="togglePlayBtn">▶/⏸</button>    <button id="stepForwardBtn">→</button>    <button onclick="recordLap()">📍</button>  </div>  <div id="speedIndicator">再生速度: 1.0x</div>  <div id="laps"></div>  <script>    const video = document.getElementById("video");    const seekbar = document.getElementById("seekbar");    const lapsDiv = document.getElementById("laps");    const stepBackwardBtn = document.getElementById("stepBackwardBtn");    const stepForwardBtn = document.getElementById("stepForwardBtn");    const toggleBtn = document.getElementById("togglePlayBtn");    const speedIndicator = document.getElementById("speedIndicator");    let fps = 30;    const step = 1 / fps;    let laps = [];    // 動画選択    document.getElementById("fileInput").addEventListener("change", function () {      const file = this.files[0];      if (file) {        video.src = URL.createObjectURL(file);        video.load();        video.onloadedmetadata = () => {          seekbar.max = video.duration;        };        laps = [];        lapsDiv.innerHTML = "";      }    });    // シークバー同期    video.ontimeupdate = () => {      seekbar.value = video.currentTime;    };    seekbar.addEventListener("input", () => {      video.currentTime = seekbar.value;    });    function stepForward() {      video.pause();      video.currentTime += step;    }    function stepBackward() {      video.pause();      video.currentTime -= step;    }    // 再生・停止（▶/⏸）＋長押しで2倍速再生    toggleBtn.textContent = "▶/⏸";    toggleBtn.addEventListener("click", () => {      if (video.paused) {        video.play();      } else {        video.pause();      }    });    toggleBtn.addEventListener("mousedown", () => {      video.playbackRate = 2.0;      video.play();    });    toggleBtn.addEventListener("touchstart", () => {      video.playbackRate = 2.0;      video.play();    });    ["mouseup", "mouseleave", "touchend"].forEach(event => {      toggleBtn.addEventListener(event, () => {        video.pause();        video.playbackRate = 1.0;      });    });    // ラップ記録（差→時間）    function recordLap() {      const time = video.currentTime;      const timeFixed = time.toFixed(2);      const lastTime = laps.length > 0 ? laps[laps.length - 1] : 0;      const diff = (time - lastTime).toFixed(2);      laps.push(time);      const container = document.createElement("div");      container.className = "lap-entry";      const text = document.createElement("span");      text.textContent = `（+${diff} 秒）Lap ${laps.length}: ${timeFixed} 秒`;      const delBtn = document.createElement("button");      delBtn.textContent = "❌";      delBtn.onclick = () => {        container.remove();      };      container.appendChild(text);      container.appendChild(delBtn);      lapsDiv.appendChild(container);    }    // 長押し再生（→）    stepForwardBtn.addEventListener("mousedown", () => {      video.playbackRate = 0.5;      video.play();    });    stepForwardBtn.addEventListener("touchstart", () => {      video.playbackRate = 0.5;      video.play();    });    ["mouseup", "mouseleave", "touchend"].forEach(event => {      stepForwardBtn.addEventListener(event, () => {        video.pause();        video.playbackRate = 1.0;      });    });    stepForwardBtn.addEventListener("click", stepForward);    // 長押し巻き戻し（←）    let reverseInterval;    stepBackwardBtn.addEventListener("mousedown", () => {      video.pause();      reverseInterval = setInterval(() => {        video.currentTime = Math.max(0, video.currentTime - 0.05);      }, 100);    });    stepBackwardBtn.addEventListener("touchstart", () => {      video.pause();      reverseInterval = setInterval(() => {        video.currentTime = Math.max(0, video.currentTime - 0.05);      }, 100);    });    ["mouseup", "mouseleave", "touchend"].forEach(event => {      stepBackwardBtn.addEventListener(event, () => {        clearInterval(reverseInterval);      });    });    stepBackwardBtn.addEventListener("click", stepBackward);    // 2本指スワイプで速度変更    let touchStartY = null;    let initialRate = 1.0;    video.addEventListener("touchstart", (e) => {      if (e.touches.length === 2) {        touchStartY = (e.touches[0].clientY + e.touches[1].clientY) / 2;        initialRate = video.playbackRate;      }    });    video.addEventListener("touchmove", (e) => {      if (e.touches.length === 2 && touchStartY !== null) {        const currentY = (e.touches[0].clientY + e.touches[1].clientY) / 2;        const delta = touchStartY - currentY; // 上に動かすと速く        let newRate = initialRate + delta * 0.01;        newRate = Math.max(0.3, Math.min(3.0, newRate));        video.playbackRate = newRate;        speedIndicator.textContent = `再生速度: ${newRate.toFixed(1)}x`;      }    });    video.addEventListener("touchend", () => {      touchStartY = null;    });  </script></body></html>